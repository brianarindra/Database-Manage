#### Database configuration - PostgreSQL ####

# Load PostgreSQL module
loadmodule "db_postgres.so"

# Core modules yang perlu koneksi database
loadmodule "usrloc.so"
loadmodule "auth_db.so"
loadmodule "acc.so"

# Konfigurasi koneksi DB untuk db_postgres
modparam("db_postgres", "db_url", "postgres://{{ db_user }}:{{ db_password }}@{{ db_host }}:{{ db_port }}/{{ db_name }}")

# Konfigurasi usrloc
modparam("usrloc", "db_mode", {{ usrloc_db_mode | default(2) }})

# Konfigurasi auth_db (pakai PostgreSQL URL yang sama)
modparam("auth_db", "db_url", "postgres://{{ db_user }}:{{ db_password }}@{{ db_host }}:{{ db_port }}/{{ db_name }}")

# Konfigurasi accounting (acc)
modparam("acc", "log_flag", {{ acc_log_flag | default(1) }})
modparam("acc", "db_flag", {{ acc_db_flag | default(1) }})
